(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-97892a12"],{"34bd":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticStyle:{"margin-top":"20px","max-width":"600px","margin-left":"80px"}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:20}},[n("el-input",{attrs:{placeholder:"输入关键字进行过滤",clearable:""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),e._v(" "),n("el-col",{attrs:{span:4}},[n("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:function(t){return e.handleCreate()}}},[n("i",{staticClass:"el-icon-plus"}),e._v(" 添加\n        ")])],1)],1),e._v(" "),n("el-row",{staticStyle:{"padding-top":"20px"}},[n("el-col",[n("el-tree",{ref:"tree",staticClass:"permission-tree",attrs:{data:e.departments,props:e.defaultProps,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,"filter-node-method":e.filterNode},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,a=t.data;return n("span",{staticClass:"custom-tree-node"},[n("span",[e._v(e._s(r.label))]),e._v(" "),n("span",[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/rest/department/add"],expression:"['/rest/department/add']"}],attrs:{type:"text",size:"mini"},on:{click:function(){return e.handleCreate(a)}}},[e._v("添加")]),e._v(" "),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/rest/department/update"],expression:"['/rest/department/update']"}],attrs:{type:"text",size:"mini"},on:{click:function(){return e.handleEdit(r,a)}}},[e._v("编辑")]),e._v(" "),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/rest/department/delete"],expression:"['/rest/department/delete']"}],attrs:{type:"text",size:"mini"},on:{click:function(){return e.handleDelete(a)}}},[e._v("删除")])],1)])}}])})],1)],1)],1),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisible,title:"edit"===e.dialogType?"编辑":"新增"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{attrs:{model:e.department,"label-width":"80px","label-position":"left"}},[n("el-form-item",{attrs:{label:"上级部门"}},[n("treeselect",{attrs:{options:e.departments,normalizer:e.normalizer,placeholder:"选择上级部门"},model:{value:e.department.parentId,callback:function(t){e.$set(e.department,"parentId",t)},expression:"department.parentId"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"部门名"}},[n("el-input",{attrs:{placeholder:"部门名"},model:{value:e.department.name,callback:function(t){e.$set(e.department,"name",t)},expression:"department.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"排序"}},[n("el-input",{attrs:{placeholder:"排序"},model:{value:e.department.sorts,callback:function(t){e.$set(e.department,"sorts",t)},expression:"department.sorts"}})],1)],1),e._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.confirmDepartment}},[e._v("确定")])],1)],1)],1)},a=[],i=(n("ac6a"),n("7f7f"),n("96cf"),n("3b8d")),s=n("ca17"),l=n.n(s),o=(n("542c"),n("4381")),c=n("653d"),d=n("ed08"),u=(n("61f7"),{id:void 0,name:"",parentId:void 0,parentName:"",levels:void 0,deleted:0}),p={name:"Department",components:{Treeselect:l.a},directives:{permission:o["a"]},data:function(){return{defaultProps:{children:"childrens",label:"name"},department:Object.assign({},u),departments:[],dialogVisible:!1,dialogType:"new",levelsOptions:[{label:"集团",key:0},{label:"分公司",key:1},{label:"部门",key:2}],filterText:""}},created:function(){this.getDepartments()},watch:{filterText:function(e){this.$refs.tree.filter(e)}},methods:{getDepartments:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["c"])();case 2:t=e.sent,n=t.result,this.diGuiTree(n),this.departments=[{id:0,name:"部门树",childrens:n}];case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},diGuiTree:function(e){var t=this;e.forEach(function(e){""===e.childrens||void 0===e.childrens||null===e.childrens?delete e.childrens:t.diGuiTree(e.childrens)})},normalizer:function(e){return{id:e.id,label:e.name,children:e.childrens}},handleCreate:function(e){this.dialogType="new",this.dialogVisible=!0,this.department=Object.assign({},u),null!=e&&(this.department.parentId=e.id,this.department.parentName=e.name)},handleEdit:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.dialogType="edit",this.dialogVisible=!0,this.department=Object(d["c"])(n),r=t.parent.data,this.department.parentId=r.id,this.department.parentName=r.name;case 6:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}(),confirmDepartment:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t="edit"===this.dialogType,!t){e.next=6;break}return e.next=4,Object(c["d"])(this.department);case 4:e.next=8;break;case 6:return e.next=8,Object(c["a"])(this.department);case 8:this.dialogVisible=!1,this.$message({showClose:!0,message:"保存成功",type:"success"}),this.getDepartments();case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleDelete:function(e){var t=this;this.$confirm("确认删除?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(c["b"])(e.id);case 2:t.$message({showClose:!0,message:"删除成功",type:"success"}),t.getDepartments();case 4:case"end":return n.stop()}},n)}))).catch(function(e){console.error(e)})}}},m=p,f=(n("5771"),n("2877")),h=Object(f["a"])(m,r,a,!1,null,null,null);t["default"]=h.exports},"393b":function(e,t,n){},4381:function(e,t,n){"use strict";n("ac4d"),n("8a81"),n("ac6a");var r=n("4360"),a={inserted:function(e,t,n){var a=t.value,i=r["a"].getters&&r["a"].getters.permissions;if(!(a&&a instanceof Array&&a.length>0&&i))throw new Error("need permissions! Like v-permission=\"['/rest/user/list']\"");var s=!1,l=!0,o=!1,c=void 0;try{for(var d,u=i[Symbol.iterator]();!(l=(d=u.next()).done);l=!0){var p=d.value;if(p.url===a[0]){s=!0;break}}}catch(m){o=!0,c=m}finally{try{l||null==u.return||u.return()}finally{if(o)throw c}}s||e.remove()}},i=function(e){e.directive("permission",a)};window.Vue&&(window["permission"]=a,Vue.use(i)),a.install=i;t["a"]=a},5771:function(e,t,n){"use strict";var r=n("393b"),a=n.n(r);a.a},"653d":function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return s}),n.d(t,"b",function(){return l});var r=n("b775");function a(){return Object(r["a"])({url:"/rest/department/all",method:"get"})}function i(e){return Object(r["a"])({url:"/rest/department/add",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/rest/department/update",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/rest/department/delete",method:"get",params:{id:e}})}}}]);